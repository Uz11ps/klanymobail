# Чеклист приемки (по ТЗ)

## 1. Доступы и роли
- [ ] Родитель регистрируется и получает `family_code`
- [ ] Ребенок отправляет заявку (`Фамилия + Имя + Family ID`)
- [ ] Родитель видит заявку и делает approve/reject
- [ ] После approve ребенок автоматически входит в приложение
- [ ] Кнопка `Выйти на всех устройствах` у родителя выкидывает ребенка из сессии
- [ ] Передача роли админа второму родителю работает

## 2. Подписки и монетизация
- [ ] Базовый тариф ограничивает детей/активные квесты/активные товары
- [ ] Промокод активируется из мобильного приложения
- [ ] Промокод импортируется CSV в веб-админке
- [ ] Создается `payment_order` для premium
- [ ] Edge Function `yookassa-create-payment` возвращает `confirmationUrl`
- [ ] Webhook `yookassa-webhook` переводит заказ в `paid` и активирует подписку

## 3. Квесты
- [ ] Родитель создает квест (тип, награда, множественные исполнители)
- [ ] Ребенок видит назначенный квест
- [ ] Ребенок отправляет фото-отчет
- [ ] Родитель подтверждает/отклоняет в разделе "Проверка"
- [ ] При подтверждении начисляется валюта

## 4. Валюта
- [ ] Баланс ребенка отображается
- [ ] История транзакций отображается
- [ ] Родитель делает ручную корректировку баланса

## 5. Магазин
- [ ] Родитель создает товар с фото
- [ ] Ребенок отправляет запрос покупки
- [ ] Средства замораживаются при запросе
- [ ] Родитель подтверждает выдачу (approve)
- [ ] Родитель отклоняет покупку (reject) и деньги возвращаются

## 6. Уведомления
- [ ] In-app уведомления отображаются и отмечаются как `read`
- [ ] Telegram `/link` и `/promo` команды работают
- [ ] `notifications-cron` создает уведомления о завершении подписки

## 7. Админка
- [ ] Доступ только для `profiles.role=admin`
- [ ] Разделы: семьи, пользователи, дети, квесты, товары, покупки, подписки, промокоды, платежи, запросы, уведомления, аудит
- [ ] Действия модерации работают (approve/reject покупок, approve/reject child requests, deactivate child)

## 8. Техническая проверка
- [ ] `flutter analyze` проходит в mobile/admin
- [ ] `flutter test` проходит в mobile/admin
- [ ] `schema.sql` применен без ошибок
- [ ] Storage buckets созданы: `quest-evidence`, `shop-products`

